services:
  # =========================
  # Telegram Music Bot Service
  # =========================
  - type: web
    name: telegram-music-bot
    runtime: docker
    plan: starter
    region: oregon
    branch: main
    dockerfilePath: Dockerfile

    envVars:
      - key: API_ID
        sync: false
      - key: API_HASH
        sync: false
      - key: BOT_TOKEN
        sync: false
      - key: SESSION_STRING
        sync: false
      - key: OWNER_ID
        sync: false

      # Redis connection (auto injected from redis service)
      - key: REDIS_URL
        fromService:
          type: redis
          name: music-bot-redis
          property: connectionString

      # Optional (only if you use Sentry)
      - key: SENTRY_DSN
        sync: false

      # Port for health check / web runtime
      - key: PORT
        value: "8080"

    healthCheckPath: /health
    autoDeploy: true
    numInstances: 1

    disk:
      name: bot-storage
      mountPath: /tmp
      sizeGB: 1

  # =========================
  # Redis Service
  # =========================
  - type: redis
    name: music-bot-redis
    plan: starter
    region: oregon
