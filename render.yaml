services:
  # =========================
  # Telegram Music Bot Service
  # =========================
  - type: web
    name: telegram-music-bot
    runtime: docker
    plan: starter
    region: oregon
    branch: main
    dockerfilePath: Dockerfile

    envVars:
      - key: API_ID
        sync: false
      - key: API_HASH
        sync: false
      - key: BOT_TOKEN
        sync: false
      - key: SESSION_STRING
        sync: false
      - key: OWNER_ID
        sync: false

      - key: REDIS_URL
        fromService:
          type: redis
          name: music-bot-redis
          property: connectionString

      - key: SENTRY_DSN
        sync: false

      - key: PORT
        value: "8080"

    healthCheckPath: /health
    autoDeploy: true
    numInstances: 1

    disk:
      name: bot-storage
      mountPath: /tmp
      sizeGB: 1

  # =========================
  # Redis Service (FIXED)
  # =========================
  - type: redis
    name: music-bot-redis
    plan: starter
    region: oregon

    # ðŸ”´ REQUIRED by Render
    ipAllowList:
      - source: 0.0.0.0/0
        description: Allow all services (can restrict later)
